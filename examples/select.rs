//!
//! Rust Firebird Client
//!
//! Example of select
//!
//! You need create a database with this table:
//! create table test (col_a int generated by default as identity, col_b float, col_c varchar(10));
//!
//! You can use the insert example to populate
//! the database ;)
//!

use rsfbclient::{ConnectionBuilder, FbError};

fn main() -> Result<(), FbError> {
    let conn = ConnectionBuilder::default()
        .host("localhost")
        .db_name("examples.fdb")
        .user("SYSDBA")
        .pass("masterkey")
        .connect()?;

    conn.with_transaction(|tr| {
        let rows = tr
            .prepare("select col_a, col_b, col_c from test")?
            .query(())?
            .into_iter();

        println!("| col_a | col_b | col_c   |");
        println!("| ----- | ----- | ------- |");
        for row in rows {
            let (col_a, col_b, col_c): (i32, f32, String) = row?;

            println!("| {:^5} | {:^5} | {:7} |", col_a, col_b, col_c);
        }

        Ok(())
    })?;

    Ok(())
}
