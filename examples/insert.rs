//!
//! Rust Firebird Client
//!
//! Example of insert
//!
//! You need create a database with this table:
//! create table test (col_a int generated by default as identity, col_b float, col_c varchar(10));
//!

use rsfbclient::{Connection, FbError};

const SQL_INSERT: &str = "insert into test (col_b, col_c) values (rand(), 'test')";

fn main() -> Result<(), FbError> {
    let conn = Connection::open("localhost", 3050, "examples.fdb", "SYSDBA", "masterkey")?;

    let tr = conn.transaction()?;

    // First alternative
    {
        tr.execute_immediate(SQL_INSERT)?;
    }

    // Second alternative
    {
        let mut stmt = tr.prepare(SQL_INSERT)?;

        stmt.execute_simple()?;
        stmt.execute_simple()?;
    }

    tr.commit()?;

    // Explicit close is optional
    conn.close()?;

    Ok(())
}
